\chapter{Introducción} \label{introduccion}


La Química estudia la composición y estructura de la materia, sus propiedades y transformaciones. Estudia las sustancias, la energía y sus cambios durante las reacciones. Desde que se tienen registros, la química ha sido fundamental para el desarrollo de la humanidad, ya que ha permitido la producción de materiales, alimentos, medicamentos y energía, entre otros. Esto ha sido un proceso lento y exhaustivo a través de la experimentación. Por ejemplo, en 1881, Beilstein publica su Manual de Química Orgánica, que recogía 15000 compuestos orgánicos con sus propiedades \cite{handbook_1881}. Conforme la química se iba expandiendo, también lo hacía el volumen de datos que se generaban, siendo cada vez mas frecuentes preguntas como ``¿alguien habrá sintetizado ya este compuesto?" \cite{applied_chemo_intro}

Eventualmente, hace unas cuantas décadas, se pensó que la cantidad de información que cada químico por su cuenta había acumulado, se podía compartir y hacer accesible a la comunidad científica a través de su almacenamiento en bases de datos \cite{chemo_a_textbook}. Con el desarrollo de técnicas de manipulación y tratamiento de esos datos surgió el término \emph{chemoinformatics} (en español, quimioinformática).

Las \emph{chemoinformatics} han cobrado gran importancia en los últimos años debido al aumento exponencial de datos experimentales generados en la investigación biomédica y química, y a la necesidad de manejar y analizar esta información de manera eficiente.
Esta disciplina ha sido influenciada por diversas áreas, como la química, matemáticas, estadística, biología y ciencias de la computación entre otras. Al parecer, su origen se remonta a la década de 1940, habiendo ya algunas investigaciones en el área, pero el término 'chemoinformatics' se lleva utilizado desde 1998 \cite{leach_introduction_2007}. Como tal, aun no hay un acuerdo en cuanto a su definición, seguramente por su carácter interdisciplinar, ni si quiera en cómo deletrearlo, pudiendo aparecer también como \emph{cheminformatics}, \emph{chemical informatics}, \emph{chemi-informatics}, y \emph{molecular informatics} entre otras \cite{leach_introduction_2007, brown_chemoinformaticsintroduction_2009}. En la literatura se discuten varias interpretaciones sobre su definición, unas más precisas y otras más generales: \cite{leach_introduction_2007, basic_overview_chemo, brown_chemoinformaticsintroduction_2009, chemo_a_textbook}


\begin{center}
\small
\textit{La mezcla de recursos de información para transformar datos en información, y la información en conocimiento, con el fin de tomar decisiones más rápidas y efectivas en la identificación y optimización de fármacos} [Brown 1998]
\end{center}

\begin{center}
\small
\textit{Chem(o)informatics es un término genérico que abarca el diseño, la creación, la organización, la gestión, la recuperación, el análisis, la difusión, la visualización y el uso de la información química. }[G. Paris 1999]
\end{center}

\begin{center}
\small
\textit{La aplicación de métodos informáticos para resolver problemas de química} [J. Gasteiger and T. Engel 2006]
\end{center}


A pesar de ello, son a día de hoy un componente esencial en el descubrimiento de sustancias químicas; sin duda es un área en constante evolución y su importancia solo aumentará en los próximos años, tanto en el descubrimiento de fármacos —que es como originariamente surgió y donde más impacto tiene en la sociedad— como en otros campos de la química.


En este ámbito son de vital importancia los sistemas de representación lineal. Algunos formatos que usan este tipo de representación son Wiswesser Line Notation (WLN), Sybyl Line Notation (SLN), Representation of structure diagram arranged linearly (ROSDAL), Simplified Molecular-Input Line-Entry System (SMILES) o IUPAC Chemical Identifier (InChI). Surgieron a medida que la química y la tecnología computacional avanzaban, y nos permiten codificar moléculas para su análisis y almacenamiento en bases de datos. En el siglo XIX, se desarrollaron varias formas de representación visual de moléculas, como las fórmulas estructurales que permitieron a los químicos dibujar y visualizar moléculas de manera más efectiva. Sin embargo, estas formas de representación no son adecuadas para su uso en la computación, ya que no son fácilmente legibles para los programas informáticos. Nosotros, los humanos, cuando vemos una estructura molecular dibujada la entendemos directamente, obtenemos una visión global de los símbolos que representan los enlaces y la distribución espacial de los átomos que la componen, pero los computadores no tienen esa facilidad. Por ello, se desarrollaron sistemas de notación lineal que permitían describir de manera más precisa y eficiente la estructura molecular, trabajando con tipos de datos sencillos, usando por ejemplo cadenas de caracteres.

Por otra parte, tenemos las herramientas, toolkits o paquetes de software que nos permiten trabajar con las chemoinformatics. Algunos de ellos son RDKit, OpenBabel, Indigo, CDK, Cactvs, OECHEM, o ChemDraw; siendo los más usados RDKit y OpenBabel (se hablará más en profundidad sobre estos dos paquetes en la Sección \ref{toolkits}).


\section{Motivación}\label{motivacion}

Los formatos de representación lineal llevan siendo un tema de interés e investigación para los científicos desde mediados del siglo XIX, evolucionando poco a poco y desarrollándose nuevas representaciones en función de las necesidades —principalmente computacionales— del momento y las limitaciones que se iban descubriendo \cite{107_years_linear_notations}. En la actualidad las más usadas son SMILES, InChI y SELFIES \cite{SELFIES}. Como comenté antes, una forma muy potente de representar moléculas y compuestos químicos es mediante cadenas de caracteres, y de esto justamente se encargan las representaciones lineales: traducir una molécula, con sus átomos, enlaces entre ellos, ciclos y otras propiedades, en una cadena de caracteres que la represente, y que la máquina y los propios químicos puedan entender. Sin embargo, hay diferencias notables entre las representaciones, tanto en la sintaxis de las cadenas que se generan como en las aplicaciones que se le puede dar a cada una de ellas.


SMILES, ideada por David Weininger, sale a la luz en 1988 satisfaciendo con creces las necesidades de procesamiento de información química que había, desbancando a la representación estandarizada del momento, Wiswesser Line Notation (WLN). Desde ese entonces SMILES se convirtió —y sigue siendo a día de hoy— en el estándar de representación lineal, ya que permite describir estructuras moleculares de una forma sencilla en un formato fácil de leer, lo que ha hecho que sea una herramienta popular en la química computacional, siendo la más usada entre investigadores y químicos. Pese a esto, SMILES tiene dos grandes inconvenientes: una misma molécula puede escribirse con varias cadenas SMILES distintas válidas, es decir, tiene sinónimos (Figura \ref{fig:sinonimos_smiles}); y no es robusto ni sintáctica ni semánticamente. En este sentido se podría generar un string que no represente una molécula válida, como lo es \emph{CC(CCCC}, el cual tiene un paréntesis sin cerrar (lo que implica que no se delimita cuándo acaba la rama). O generar una molécula que no sea químicamente viable como \emph{CO=CC}, que muestra un átomo de oxígeno neutro formando tres enlaces (superando el límite de enlaces covalentes que un oxígeno neutro puede tener) \cite{SELFIES}.

\begin{figure}[h!]
\centering
    \includegraphics[scale=0.4]{imagenes/intro/sinonimos.png}
    \caption{Distintas cadenas SMILES válidas para el 1-methyl-3-bromo-ciclohexeno. \textbf{(a)} Considera el ciclo como la rama principal y el bromo como ramificación. \textbf{(b)} Hace el recorrido que marca la flecha, dejando parte del ciclo como una ramificación. Imagen extraída de \cite{weininger_smiles_1988}.}
    \label{fig:sinonimos_smiles}
\end{figure}

Esto tiene especial relevancia en el ámbito del Machine Learning (ML) o Aprendizaje Automático. Aunque se sale del alcance de este trabajo, uno de los grandes objetivos de la química computacional es la creación o diseño de nuevas moléculas. Se podrían crear modelos de ML, en particular de redes neuronales, capaces de generar moléculas ficticias válidas, para posteriormente ver sus propiedades, valorarlas energéticamente para ver cuán estables son y estudiar su viabilidad en distintas aplicaciones, entre otras cosas. SMILES dificulta esta tarea, y por ello, aparece en 2020, SELFIES (SELF-referencIng Embedded Strings), una nueva representación lineal 100\% robusta, muy usada actualmente para modelos generativos (ver \cite{SELFIES, krenn_self_referencing_2020} para más detalles de cómo soluciona los problemas de robustez y otras características de la representación). SELFIES es relativamente reciente por lo que aun no termina de instaurarse entre la comunidad investigadora, pese a esto, está continuamente ampliando sus funcionalidades, mejorando en simplicidad y facilidad de uso \cite{selfies_recent_2023}. Por último, InChI es creado en 2013 por la IUPAC (International Union of Pure and Applied Chemistry) como un proyecto para estandarizar el proceso de búsqueda de estructuras moleculares entre distintas bases de datos. Esto es porque InChI (International Chemical Identifier) genera una cadena canónica única para cada molécula, de manera que cada molécula tiene una sola representación, y dicha representación solamente hace referencia a esa molécula. La principal desventaja radica en su sintaxis y su estructura jerárquica, haciéndola complicada de leer y utilizar por los humanos. Por esto mismo, no es la mejor opción para usar en modelos generativos, pues tiene una serie de reglas y normas gramaticales y aritméticas que son complejas de aplicar al generar moléculas a través de modelos de ML\cite{heller_inchi_2015}. Por lo anteriormente comentado, por su uso tan extendido, por su facilidad de uso y legibilidad frente a las demás representaciones, me centraré en la notación SMILES durante el desarrollo de este trabajo. 

Desde la Universidad de Granada, la tutora de este TFG colabora con el grupo de investigación del ICIQ (Instituto Catalán de Investigación Química) liderado por la investigadora Mónica H. Pérez-Temprano\footnote{de aquí en adelante se hará referencia a esta colaboración como ``los expertos''}. Su foco de investigación gira en torno al entendimiento de transformaciones catalíticas en las que participan compuestos organometálicos, descubriendo y diseñando reacciones más eficientes basadas en catalizadores metálicos (para más detalle sobre el grupo de investigación y sus ámbitos de trabajo, ver su sitio web \cite{ICIQ}). En resumen, intentan desarrollar enfoques más sostenibles para la síntesis de moléculas orgánicas usando la química organometálica. Como tal, necesitan codificar correctamente una molécula de organometálica en pos de trabajar con ella adecuadamente y utilizar todas las herramientas, para, entre otras cosas, poder dibujarla y entenderla mejor.

Los químicos de este centro comentan que uno de los principales problemas que se detectan en este ámbito es la heterogeneidad en las distintas bases de datos para un mismo compuesto o molécula. Dicho esto, existen diversas bases de datos en química donde se recoge gran cantidad de información acerca de los compuestos. Entiéndase esto como una colección estructurada y organizada que contiene datos sobre compuestos químicos, sus propiedades y relaciones con otros compuestos. Se utilizan para almacenar y recuperar información sobre moléculas, sustancias, reacciones, propiedades fisicoquímicas, e incluso literatura científica relacionada. Mencionaré ahora las más importantes y las que serán objeto de interés:

\begin{itemize}
    \item \emph{SciFinder}, una herramienta de investigación muy potente que permite explorar las bases de datos de CAS (American Chemical Society) las cuales contienen literatura sobre Química y otras disciplinas afines como Física, Biomedicina, Geología, Ingeniería Química, etc. Incluye referencias bibliográficas y resúmenes de artículos, informes, y libros entre otras cosas. Permite realizar búsquedas por estructura, nombres de sustancias o identificadores, reacciones en la que participa dicha sustancia, artículos y publicaciones que nombren el compuesto en cuestión, e incluso proveedores de compra \cite{scifinder_website}. Para el uso de esta herramienta es necesario acceder mediante la red de una institución autorizada (en este caso trabajo mediante la VPN de la UGR) y seguir los pasos para registrarte\footnote{Pasos para el registro en SciFinder\url{https://bibliotecaugr.libguides.com/scifinder_scholar}}.

    \item \emph{Sigma-Aldrich}, una compañía de ciencia, química y biotecnología que se dedica a la producción y venta de productos químicos, reactivos, equipos y materiales de laboratorio. Ofrece herramientas, servicios, artículos y una gran variedad de productos químicos que se utilizan en investigación, biofarmacéutica, e industria entre otros ámbitos \cite{sigma_aldrich_web}. A través de su página web se enfocan al comercio electrónico pudiendo buscar y comprar productos, compuestos orgánicos e inorgánicos, agentes reactivos, isótopos para síntesis químicas, proteínas, enzimas, etc. De cada producto muestra información relevante como la ficha de datos de seguridad, detalles de las propiedades físicas y químicas así como algunas representaciones lineales del compuesto y la representación molecular en 2D.
    
    \item \emph{PubChem}, una base de datos abierta que sirve información a millones de usuarios en todo el mundo, desde investigadores y estudiantes hasta el público general. Recogen para cada compuesto, información sobre su estructura, representaciones 2D y 3D, identificadores, propiedades químicas y físicas, patentes, avisos de toxicidad, etc. \cite{pubchem_website} 
\end{itemize}
    
 Para ilustrar el problema de la heterogeneidad entre bases de datos, presento las Tablas \ref{tabla:tabla_peq_intro_sigmaAldrich} y \ref{tabla:tabla_peq_intro_sciFinder}. Ambas tablas comparan las mismas moléculas, mostrando el código SMILES y la representación visual que ofrecen las bases de datos Sigma-Aldrich y SciFinder respectivamente. Vemos diferencias claras en el tratamiento de los ciclos aromáticos, la especificación de las cargas de los átomos y la posición de algunas ramificaciones. Utilizo un subconjunto de 5 moléculas pertenecientes a la organometálica, seleccionadas desde un conjunto de datos de 30 moléculas considerados de interés por los químicos del ICIQ (disponible para su consulta en GitHub). En el Apéndice \ref{apend:pagina_tabla_intro_grande}, se puede consultar una tabla comparativa con el set de moléculas al completo. 





\begin{landscape}
    \begin{table}
  \begin{minipage}{.5\linewidth}
    \centering
    \begin{tabular}{m{0.3cm}m{4.8cm}>{\centering\arraybackslash}m{4cm}}
        \toprule
        \textbf{Id} & \textbf{Código SMILES} & \textbf{Representación 2D} \\
        \midrule
        1 &
        C[Au].c1ccc(cc1) P(c2ccccc2)c3ccccc3 & \includegraphics[width=2.7cm]{imagenes/sigmaAldrich/Methyl(triphenylphosphine)gold(I)} \\ [0.8cm]
        % \hline

        2 &
        Cl[Pd]Cl.C1CC=CCCC=C1 & \includegraphics[width=2.8cm]{imagenes/sigmaAldrich/Dichloro(1,5-cyclooctadiene)palladium(II).png} \\ 
        % \hline
        
        3 &
        Cl[Au].CP(C)C & \includegraphics[width=2.8cm]{imagenes/sigmaAldrich/Chloro(trimethylphosphine)gold(I).png} \\ [0.8cm]
        % \hline

        4 &
        Cl[Au].CC(C)(C)P(c1ccccc1-c2ccccc2)C(C)(C)C & \includegraphics[width=2.8cm]{imagenes/sigmaAldrich/Chloro[(1,1-biphenyl-2-yl)di-tert-butylphosphine]gold(I).png} \\
        % \hline

        5 &
        [Fe]I.[C-]\#[O+].[C-]\#[O+].[CH]1[CH][CH][CH][CH]1 & \includegraphics[width=2.7cm]{imagenes/sigmaAldrich/Dicarbonylcyclopentadienyliodoiron(II).png} \\
        \bottomrule
        \end{tabular}
    \caption{Códigos SMILES y sus representaciones visuales según Sigma-Aldrich}
    \label{tabla:tabla_peq_intro_sigmaAldrich}
  \end{minipage}%
  \begin{minipage}{.5\linewidth}
    \centering
    \begin{tabular}{m{0.1cm}m{4.8cm}>{\centering\arraybackslash}m{4cm}}
        \toprule
        & \textbf{Código SMILES} & \textbf{Representación 2D} \\
        \midrule
        &
        [Au+]([CH3-])[P] (C=1C=CC=CC1)(C=2C=C C=CC2)C=3C=CC=CC3 & \includegraphics[width=2.2cm]{imagenes/sciFinder/pdf/Methyl(triphenylphosphine)gold(I).pdf} \\
        % \hline

        &
        [Cl-][Pd+2]123([Cl-]) [CH]=4CC[CH]3=[CH]2CC[CH]41 & \includegraphics[width=2.2cm]{imagenes/sciFinder/pdf/Dichloro(1,5-cyclooctadiene)palladium(II).pdf} \\
        % \hline

        &
        [Cl-][Au+][P](C)(C)C & \includegraphics[width=2.2cm]{imagenes/sciFinder/pdf/Chloro(trimethylphosphine)gold(I).pdf} \\
        % \hline
        
        &
        [Cl-][Au+][P](C=1C=CC=C C1C=2C=CC=CC2) (C(C)(C)C)C(C)(C)C & \includegraphics[width=2.2cm]{imagenes/sciFinder/pdf/Chloro[(1,1-biphenyl-2-yl)di-tert-butylphosphine]gold(I).pdf} \\
        % \hline
        
        &
        O\#C[Fe+2]1234([I-])(C\#O) [CH]=5[CH]4=[CH]3[CH-] 2[CH]51 & \includegraphics[width=2.2cm]{imagenes/sciFinder/pdf/Dicarbonylcyclopentadienyliodoiron(II).pdf} \\
        \bottomrule
        \end{tabular}
    \caption{Códigos SMILES y sus representaciones visuales según SciFinder}
    \label{tabla:tabla_peq_intro_sciFinder}
  \end{minipage}
\end{table}
\end{landscape}





\section{Objetivos}\label{objetivos}
El objetivo principal de este Trabajo Fin de Grado es mejorar las herramientas existentes para trabajar con chemoinformatics, adaptándolas a moléculas organometálicas y poder suplir los errores encontrados en las bases de datos disponibles. Para ello, se establecen los siguientes subobjetivos:
\begin{itemize}
    \item Analizar las distintas bases de datos químicas disponibles y evaluar similitudes y diferencias en el almacenado de moléculas organometálicas.
    \item Diseñar una metodología para representar de forma canónica una molécula organometálica. Esto es, una representación única y estandarizada para una molécula dada, independientemente de la forma en que se haya representado inicialmente.
    \item Mejorar la visualización de moléculas organometálicas.
\end{itemize} 

\section{Estructura de la memoria}
\begin{itemize}
    \item \textbf{Capítulo 1. Introducción}: se presenta el proyecto indicando la problemática a tratar, los motivos por los que se ha desarrollado y sus objetivos. 
    \item \textbf{Capítulo 2. Estado del arte y fundamentos teóricos}: breve revisión bibliográfica del tema del proyecto, estado de las soluciones actuales y conceptos teóricos necesarios para comprender el trabajo.
    \item \textbf{Capítulo 3. Gestión del proyecto y planificación}: descripción de la metodología de desarrollo seguida y planificación temporal. Se detalla también la gestión de recursos, el desglose del presupuesto y se realiza un análisis de riesgos del proyecto.
    \item \textbf{Capítulo 4. Diseño}: se describen las clases y métodos creados, dando una breve explicación de cada una de ellos. Definición del sistema canónico alcanzado junto con sus reglas y los cambios en el sistema de representación 2D. 
    \item \textbf{Capítulo 5. Resultados y pruebas}: resultados generales tras la implementación y descripción de las pruebas llevadas a cabo.
    \item \textbf{Capítulo 6. Conclusiones y trabajos futuros}: exposición de las conclusiones del proyecto, y posibles ampliaciones para el futuro.
\end{itemize}
